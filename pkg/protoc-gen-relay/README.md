# protoc-gen-relay

The `protoc-gen-relay` is a `protoc` plugin for Go. This plugin automates the generation of code needed to register Relay circuit breakers for each service in your gRPC server. It's an invaluable tool when managing numerous services, as it eliminates the need for manually creating Relay configurations for every service.

## Getting Started

To use this package, you will need to have the Protocol Buffers Compiler (`protoc`) installed. If you don't have it, you can get it from the [protocol buffers Github repository](https://github.com/protocolbuffers/protobuf). Once you've done that, you can use `protoc-gen-relay` to generate relay configurations for your protobuf files.

## Building the Plugin

Before using the plugin, you need to build it. You can do so by following these steps:

1. Make sure you have a correctly configured Go environment.
2. Navigate to the directory where `protoc-gen-relay/main.go` is located.
3. Run `go build` to build the plugin. This will create an executable file in the same directory named `protoc-gen-relay`.

Now, the `protoc-gen-relay` executable can be used as a plugin with `protoc`.

## Test

Run `go test` to execute the test suite.

The tests create a protobuf file, generate code using `protoc-gen-relay`, and then check the resulting output to ensure it's as expected.


## Usage

Once you've installed the package, you can use it with the `protoc` command like so:

```shell
protoc --plugin ./protoc-gen-relay --relay_out=. --proto_path=. ./path_to_your_proto_file
```

This will generate Go code for your Relay configuration.

The generated code will look something like this:

```go
// Code generated by protoc-gen-relay. DO NOT EDIT.
// versions:
// 	protoc-gen-relay v1.0.0
// 	protoc        v3.14.0
// source: your_proto_file.proto
package your_package

import (
	"github.com/telia-oss/relay"
)

func RegisterServiceRelay(config relay.Config) *relay.Relay {
	return relay.Must(relay.New(*config.Name, config))
}
```

